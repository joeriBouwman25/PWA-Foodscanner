const video=document.querySelector("video"),hiddenDiv=document.querySelector("div");async function startCameraStream(){const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});video.srcObject=e,await video.play()}hiddenDiv&&hiddenDiv.classList.remove("none"),"serviceWorker"in navigator&&window.addEventListener("load",(async()=>(await navigator.serviceWorker.register("/worker.js")).update()));const detectBarcode=async function(){const e=new BarcodeDetector;window.setInterval((async()=>{const a=await e.detect(video);!a.length<=0&&(window.location.href="scanner/"+a[0].rawValue)}),100)};async function createScanner(){const e=document.getElementsByClassName("loader")[0],a=document.getElementsByClassName("hiddenDiv")[0];e&&a&&a.classList.remove("active"),e.classList.add("active"),await startCameraStream(),await detectBarcode(),a.classList.add("active"),e.classList.remove("active")}"/scanner"===window.location.pathname&&createScanner();
